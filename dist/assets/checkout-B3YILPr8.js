import{l as f,h as v,g as E,a as d,s as h,u as I}from"./utils-BdbU3szs.js";/* empty css              */import{g as k,c as B}from"./maps-api-EuzlYBXp.js";const p="so-cart",b=.08,C=10,L=2,D=0;let l=!1,c=!1,u="delivery";function m(){const e=document.getElementById("place-order-btn");u==="pickup"?e.disabled=!l:e.disabled=!(l&&c)}function y(e,t){if(!e||e.length===0)return;const n=e.reduce((i,r)=>i+r.price*r.quantity,0),s=n*b;let o=0;t==="delivery"?(o=C+(e.length>1?(e.length-1)*L:0),document.getElementById("shipping-row").style.display="block"):(o=D,document.getElementById("shipping-row").style.display="none");const a=n+s+o;document.getElementById("subtotal-display").textContent=`$${n.toFixed(2)}`,document.getElementById("tax-display").textContent=`$${s.toFixed(2)}`,document.getElementById("shipping-display").textContent=`$${o.toFixed(2)}`,document.getElementById("total-display").textContent=`$${a.toFixed(2)}`}function S(e){const t=document.getElementById("calendar-container");if(!t)return;const n=(e||[]).map(i=>new Date(i.start.dateTime||i.start.date).toISOString().split("T")[0]),s=new Date,o=new Date;o.setDate(s.getDate()+90);const a=setInterval(()=>{window.flatpickr&&(clearInterval(a),flatpickr(t,{minDate:s,maxDate:o,disable:n,inline:!0,onChange:()=>{l=!0,m()}}))},100)}async function g(e){const t=document.getElementById("street-address").value,n=document.getElementById("city").value,s=document.getElementById("state").value,o=document.getElementById("zip").value,a=document.getElementById("delivery-message");if(t&&n&&s&&o){const i=await B();c=i,i?(a.textContent="✅ Your address is within our delivery range!",a.classList.add("success-message"),a.classList.remove("error-message")):(a.textContent="❌ Sorry, your address is outside our delivery range.",a.classList.add("error-message"),a.classList.remove("success-message"))}else c=!1,a.textContent="";m(),y(e,"delivery")}function x(e){const t=document.getElementById("delivery-toggle"),n=document.getElementById("pickup-toggle"),s=document.getElementById("address-section"),o=document.getElementById("map-container"),a=document.getElementById("pickup-info-card"),i=r=>{u=r,r==="delivery"?(s.style.display="block",o.style.display="block",a.style.display="none",t.classList.add("active"),n.classList.remove("active"),g(e)):(s.style.display="none",o.style.display="none",a.style.display="block",t.classList.remove("active"),n.classList.add("active"),y(e,"pickup"),m())};t.addEventListener("click",()=>i("delivery")),n.addEventListener("click",()=>i("pickup")),i("delivery")}function P(){const e=document.getElementById("place-order-btn");e.addEventListener("click",()=>{e.disabled&&(l?!c&&u==="delivery"&&d("Please enter a valid address within our delivery zone."):d("Please select a pickup or delivery date from the calendar."))})}async function T(e){e.preventDefault();const t=document.getElementById("checkout-form");if(t.checkValidity()){const n=new FormData(t),s=Object.fromEntries(n.entries());console.log("Form data submitted:",s),h(p,[]),I(),d("Placing your order...",3e3),setTimeout(()=>{t.reset(),document.querySelector("main.page-container").innerHTML='<h1>Thank You!</h1><p>Your order has been placed successfully.</p><a href="/order/" class="btn-primary">Continue Shopping</a>'},3e3)}else t.reportValidity(),d("Please fill out all required fields.")}async function w(){await f(),v();const e=E(p);if(!e||e.length===0){document.querySelector("main.page-container").innerHTML='<h1>Your Cart is Empty</h1><p>There are no items in your cart to check out.</p><a href="/order/" class="btn-primary">Explore Our Coffees</a>';return}const t=await k();S(t),y(e,"delivery"),x(e),P(),document.getElementById("checkout-form").addEventListener("submit",T),["street-address","city","state","zip"].forEach(s=>{document.getElementById(s).addEventListener("blur",()=>g(e))})}w();
