import{l as f,h as v,g as E,a as l,s as h,u as I}from"./utils-BdbU3szs.js";/* empty css              */import{g as B,c as k}from"./maps-api-W5OxXTI8.js";const g="so-cart",b=.08,C=10,L=2,T=0;let r=!1,c=!1,u="delivery";function m(){const e=document.getElementById("place-order-btn");u==="pickup"?e.disabled=!r:e.disabled=!(r&&c)}function y(e,t){if(!e||e.length===0)return;const n=e.reduce((s,i)=>s+i.price*i.quantity,0),o=n*b;let a=0;t==="delivery"?(a=C+(e.length>1?(e.length-1)*L:0),document.getElementById("shipping-row").style.display="block"):(a=T,document.getElementById("shipping-row").style.display="none");const d=n+o+a;document.getElementById("subtotal-display").textContent=`$${n.toFixed(2)}`,document.getElementById("tax-display").textContent=`$${o.toFixed(2)}`,document.getElementById("shipping-display").textContent=`$${a.toFixed(2)}`,document.getElementById("total-display").textContent=`$${d.toFixed(2)}`}function x(e=[]){const t=document.getElementById("calendar-container");if(!t)return;const n=a=>{for(const d of e){const s=new Date(d.start.dateTime),i=new Date(d.end.dateTime);if(a>=s&&a<i)return!0}return!1},o=setInterval(()=>{window.flatpickr&&(clearInterval(o),flatpickr(t,{inline:!0,enableTime:!0,noCalendar:!0,dateFormat:"h:i K",minDate:"today",maxDate:"today",minTime:"09:00",maxTime:"17:00",minuteIncrement:60,disable:[n],onChange:()=>{r=!0,m()}}))},100)}async function p(e){const t=document.getElementById("street-address").value,n=document.getElementById("city").value,o=document.getElementById("state").value,a=document.getElementById("zip").value,d=`${t}, ${n}, ${o} ${a}`,s=document.getElementById("delivery-message");if(t&&n&&o&&a){const i=await k(d);c=i,i?(s.textContent="✅ Your address is within our delivery range!",s.classList.add("success-message"),s.classList.remove("error-message")):(s.textContent="❌ Sorry, your address is outside our delivery range.",s.classList.add("error-message"),s.classList.remove("success-message"))}else c=!1,s.textContent="";m(),y(e,"delivery")}function P(e){const t=document.getElementById("delivery-toggle"),n=document.getElementById("pickup-toggle"),o=document.getElementById("address-section"),a=document.getElementById("map-container"),d=document.getElementById("pickup-info-card"),s=i=>{u=i,i==="delivery"?(o.style.display="block",a.style.display="block",d.style.display="none",t.classList.add("active"),n.classList.remove("active"),p(e)):(o.style.display="none",a.style.display="none",d.style.display="block",t.classList.remove("active"),n.classList.add("active"),y(e,"pickup"),m())};t.addEventListener("click",()=>s("delivery")),n.addEventListener("click",()=>s("pickup")),s("delivery")}function w(){const e=document.getElementById("place-order-btn");e.addEventListener("click",()=>{e.disabled&&(r?!c&&u==="delivery"&&l("Please enter a valid address within our delivery zone."):l("Please select a pickup or delivery date from the calendar."))})}async function D(e){e.preventDefault();const t=document.getElementById("checkout-form");if(t.checkValidity()){const n=new FormData(t),o=Object.fromEntries(n.entries());console.log("Form data submitted:",o),h(g,[]),I(),l("Placing your order...",3e3),setTimeout(()=>{t.reset(),window.location.href="/thankyou/"},3e3)}else t.reportValidity(),l("Please fill out all required fields.")}async function F(){await f(),v();const e=E(g);if(!e||e.length===0){document.querySelector("main.page-container").innerHTML='<h1>Your Cart is Empty</h1><p>There are no items in your cart to check out.</p><a href="/order/" class="btn-primary">Explore Our Coffees</a>';return}const t=await B();x(t),y(e,"delivery"),P(e),w(),document.getElementById("checkout-form").addEventListener("submit",D),["street-address","city","state","zip"].forEach(o=>{document.getElementById(o).addEventListener("blur",()=>p(e))})}F();
